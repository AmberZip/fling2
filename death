local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local StarterGui = game:GetService("StarterGui")
local RunService = game:GetService("RunService")

-- === SETTINGS ===
local Targets = {"All"}
local FlingToggle = false
local AllBool = false

-- === GUI BUTTON ===
local ScreenGui = Instance.new("ScreenGui", Player:WaitForChild("PlayerGui"))
ScreenGui.Name = "FlingToggleUI"
ScreenGui.ResetOnSpawn = false

local Button = Instance.new("TextButton", ScreenGui)
Button.Size = UDim2.new(0, 120, 0, 40)
Button.Position = UDim2.new(0, 10, 1, -50)
Button.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
Button.TextColor3 = Color3.fromRGB(255, 255, 255)
Button.Text = "Fling [OFF]"
Button.Font = Enum.Font.SourceSansBold
Button.TextSize = 18
Button.BorderSizePixel = 0
Button.BackgroundTransparency = 0.1
Button.AutoButtonColor = false

Button.MouseButton1Click:Connect(function()
	FlingToggle = not FlingToggle
	Button.Text = FlingToggle and "Fling [ON]" or "Fling [OFF]"
end)

-- === UTILITIES ===
local function Message(title, text, duration)
	pcall(function()
		StarterGui:SetCore("SendNotification", {
			Title = title,
			Text = text,
			Duration = duration
		})
	end)
end

local function GetPlayer(name)
	name = name:lower()
	if name == "all" or name == "others" then
		AllBool = true
		return
	end
	for _, player in ipairs(Players:GetPlayers()) do
		if player.Name:lower():sub(1, #name) == name then
			return player
		end
	end
end

-- === FLING FUNCTION ===
local function SkidFling(TargetPlayer)
	local Character = Player.Character
	local Humanoid = Character and Character:FindFirstChildOfClass("Humanoid")
	local RootPart = Humanoid and Character:FindFirstChild("HumanoidRootPart")
	if not (Character and Humanoid and RootPart) then return end

	local TCharacter = TargetPlayer.Character
	local TRootPart = TCharacter and TCharacter:FindFirstChild("HumanoidRootPart")
	if not TCharacter or not TRootPart then return end
	if TRootPart.Position.Magnitude == math.huge then return end

	local BV = Instance.new("BodyVelocity")
	BV.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
	BV.Velocity = Vector3.new(0, 0, 0)
	BV.Parent = RootPart

	local start = tick()
	while tick() - start < 0.4 and Player.Character and TargetPlayer.Character and Humanoid.Health > 0 do
		local targetPos = TRootPart.Position
		RootPart.CFrame = CFrame.new(targetPos + Vector3.new(0, 1.5, 0))
		RootPart.Velocity = Vector3.new(1e10, 1e10, 1e10)
		RootPart.RotVelocity = Vector3.new(1e10, 1e10, 1e10)
		task.wait(0.005)
	end

	BV:Destroy()
end

-- === INFINITE LOOP ===
task.spawn(function()
	while true do
		if FlingToggle and Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
			pcall(function()
				if #Targets > 0 then
					AllBool = false
					for _, target in pairs(Targets) do
						local targetPlayer = GetPlayer(target)
						if AllBool then
							for _, other in ipairs(Players:GetPlayers()) do
								if other ~= Player then SkidFling(other) end
							end
						elseif targetPlayer and targetPlayer ~= Player and targetPlayer.UserId ~= 1414978355 then
							SkidFling(targetPlayer)
						end
					end
				end
			end)
		end
		task.wait(0.005) -- 10x faster
	end
end)

-- === RESPAWN SUPPORT ===
Player.CharacterAdded:Connect(function()
	repeat task.wait() until Player.Character and Player.Character:FindFirstChild("HumanoidRootPart")
end)

-- === GREETING ===
Message("Script by AnthonyIsntHere", "Toggle fling in bottom left", 5)
